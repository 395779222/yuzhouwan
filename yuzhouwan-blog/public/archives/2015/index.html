<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Archives: 2015 | Asdf&#39;s Blog</title>
  <meta name="author" content="asdf">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta annotation.property="og:site_name" content="Asdf&#39;s Blog"/>

  
    <meta annotation.property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="alternate" href="/atom.xml" title="Asdf&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Asdf&#39;s Blog</a></h1>
  <h2><a href="/">using hexo</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
    <li> <a href="/atom.xml">RSS</a> </li>
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title">2015</h2>


  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-08-13T11:50:21.000Z"><a href="/2015/08/13/Real-time-ML-with-Spark/">Aug 13 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/08/13/Real-time-ML-with-Spark/">Real-time ML with Spark</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="什么是_Spark?"><strong><font color="blue"><em>什么是 Spark?</em></font></strong></h2>
<p>&nbsp;&nbsp; <font size="3"> Apache Spark™ is a fast and general engine for large-scale data processing. - - <a href="http://spark.apache.org/" target="_blank" rel="external">Official website</a></font></p>
<p><br></p>
<h2 id="为什么要有_Spark?"><strong><font color="blue"><em>为什么要有 Spark?</em></font></strong></h2>
<h3 id="分布式">分布式</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">具备经济、快速、可靠、易扩充、数据共享、设备共享、通讯方便、灵活等分布式所具备的特性</div></pre></td></tr></table></figure>

<h3 id="高层次抽象">高层次抽象</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RDD (Resilient Distributed Datasets) 提供 一个可以被并行计算的 不变、分区的数据集 抽象</div></pre></td></tr></table></figure>

<h3 id="快速计算能力">快速计算能力</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">内存计算 基于内存的迭代计算框架，能够避免计算结果落地，磁盘 I/O 所带来的瓶颈</div><div class="line">Machine Learning、Data mining 等多需要递归地计算，因此非常适合实现这些算法</div></pre></td></tr></table></figure>

<h3 id="高效性能">高效性能</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">DAG (Directed Acyclic Grap) 利用有向无环图，构建优化任务中 父 RDD 和 子 RDD 的依赖关系  (Like Ooize)</div><div class="line">依赖分为两种，一个为窄依赖，如 map/filter/union 等；另一种为宽依赖，如 groupByKey 等</div><div class="line">在划分依赖时，join 需要额外考虑 <span class="string">"co-partitioner"</span>：</div><div class="line">    <span class="number">1.</span> 如果 RDD 和 cogroup 有相同的 数据结构，将会确定一个 OneToOneDependency</div><div class="line">    <span class="number">2.</span> 反之，则说明 join 的时候，需要 shuffle (ShuffleDependency)</div><div class="line">[建议]:<span class="string">"wide dependencies 只有等到所有 父 partiton 计算完，并传递结束，才能继续进行下一步运算，所以应尽量减少宽依赖，避免失败后 recompute 的成本"</span></div></pre></td></tr></table></figure>

<h3 id="容错性">容错性</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lineage 血统，能在计算失败的时候，将会找寻 最小重新计算损耗的 结点，而不是全部重复计算</div></pre></td></tr></table></figure>

<p><br></p>
<h2 id="Spark_核心组件"><strong><font color="blue"><em>Spark 核心组件</em></font></strong></h2>
<h3 id="Spark_SQL">Spark SQL</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">同时支持 HiveQL/UDFs/SerDes 等多样性的数据源，并采用 JDBC/ODBC 等标准化连接驱动，保证其通用性</div></pre></td></tr></table></figure>

<h3 id="Spark_GraphX">Spark GraphX</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">支持在 graph 或 collection 中查看数据，并提供丰富的 图形处理 API</div></pre></td></tr></table></figure>

<h3 id="Spark_Streaming">Spark Streaming</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">将数据流 按 时间间隔 Duration 划分为一组连续的 RDD，这些 RDD 抽象为 DStream</div><div class="line">随后，通过对 DStream 这个 high-level 抽象的操作，实现对底层 标记了 时间间隙 的 RDD 组的操控</div></pre></td></tr></table></figure>

<h3 id="Spark_MLbase">Spark MLbase</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">提供了对 Machine Learning 的易用、高效的实现</div><div class="line">总体的结构，基于 Spark，自底向上分别是，MLlib/MLI/ML Optimizer。</div><div class="line">    <span class="number">1.</span> MLlib 这一层，设计了 本地/分布式 的矩阵，对稀疏数据的支持，多模型的训练，提供了 计算模型 和 逻辑的 API</div><div class="line">    <span class="number">2.</span> MLI 主要任务则是 提供 表针采集器 和 逻辑规则，并进一步对 高层次 ML 编程抽象成接口</div><div class="line">    <span class="number">3.</span> ML Optimizer 则是通过自动构建 ML 的 pipe 管道路径实现 ML 优化器的作用。</div><div class="line">       同时，此优化器还解决了一个在 MLI 和 MLlib 中 表征采集器 和 ML 逻辑规则的搜索问题</div></pre></td></tr></table></figure>

<p><br></p>
<h2 id="Spark_实时机器学习"><strong><font color="blue"><em>Spark 实时机器学习</em></font></strong></h2>
<h3 id="什么是机器学习？">什么是<a href="https://en.wikipedia.org/wiki/Machine_learning" target="_blank" rel="external">机器学习</a>？</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Wikipedia 给出的定义是，一个计算机科学的子领域，由 模式识别 和 人工智能中的计算机学习理论 演变而来</div><div class="line">探索 结构化的、可学习的规则引擎，如何用来对数据 进行训练 和 预测</div></pre></td></tr></table></figure>

<h3 id="什么又是_Real-time_机器学习呢？">什么又是 Real-time 机器学习呢？</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">一般性的 机器学习 的对象 是一堆 offline 的训练集，通过对这些数据的学习，来确立模型</div><div class="line">如果数据是快速变化的，这时就需要将 新数据 分配好权重，加入到目标训练集中；之后，将预测出来的结果，再次反馈到 数据模型中去</div></pre></td></tr></table></figure>

<h3 id="Real-time_和_No_Real-time_的本质区别在哪儿？">Real-time 和 No Real-time 的本质区别在哪儿？</h3>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">因为 实时模型 是动态更新的，实现算法上，比 非实时的 ML 需要考虑，如何避免依赖 将 新数据 和 旧数据 整合在一块再计算所带来的性能问题</div><div class="line">更多时候，长期积累的数据，是很难再做到全量计算 (Like 多项式贝叶斯 Multinomial naive bayes, 用于处理 dataset 过大，而内存不足的情况)</div></pre></td></tr></table></figure>

<p><br></p>
<h2 id="利用_Spark_实现_Real-time_ML"><strong><font color="blue"><em>利用 Spark 实现 Real-time ML</em></font></strong></h2>
<h3 id="源数据流">源数据流</h3>
<p>&nbsp;&nbsp; <font size="2"> I.    利用 java.util.Random 产生满足高斯分布的随机数据，再通过 <a href="http://www.scalanlp.org/" target="_blank" rel="external">breeze</a> 放入到 vector 中，作为 特征值<br>&nbsp;&nbsp; <font size="2"> II.    在 generateNoisyData 中，将这个 vector 做 inner product, 并加入一点噪声数据，作为 label</font></font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> MaxEvents = <span class="number">100</span></div><div class="line"><span class="keyword">val</span> NumFeatures = <span class="number">100</span></div><div class="line"><span class="keyword">val</span> random = <span class="keyword">new</span> Random()</div><div class="line"></div><div class="line"><span class="keyword">def</span> generateRandomArray(n: Int) = Array.tabulate(n)(_ =&gt; random.nextGaussian())</div><div class="line"></div><div class="line"><span class="keyword">val</span> w = <span class="keyword">new</span> DenseVector(generateRandomArray(NumFeatures))</div><div class="line"><span class="keyword">val</span> intercept = random.nextGaussian() * <span class="number">10</span></div><div class="line"></div><div class="line"><span class="keyword">def</span> generateNoisyData(n: Int) = {</div><div class="line">  (<span class="number">1</span> to n).map { i =&gt;</div><div class="line">    <span class="keyword">val</span> x = <span class="keyword">new</span> DenseVector(generateRandomArray(NumFeatures))</div><div class="line"></div><div class="line">    <span class="comment">// inner product</span></div><div class="line">    <span class="keyword">val</span> y: Double = w.dot(x)</div><div class="line">    <span class="keyword">val</span> noisy = y + intercept</div><div class="line">    (noisy, x)</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> III.    通过 socket 将数据 发送到指定端口</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (args.length != <span class="number">2</span>) {</div><div class="line">  System.err.println(<span class="string">"Usage: &lt;port&gt; &lt;millisecond&gt;"</span>)</div><div class="line">  System.exit(<span class="number">1</span>)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">val</span> listener = <span class="keyword">new</span> ServerSocket(args(<span class="number">0</span>).toInt)</div><div class="line"></div><div class="line"><span class="keyword">while</span> (<span class="keyword">true</span>) {</div><div class="line">  <span class="keyword">val</span> socket = listener.accept()</div><div class="line"></div><div class="line">  <span class="keyword">new</span> Thread() {</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="keyword">def</span> run = {</div><div class="line"></div><div class="line">      println(<span class="string">"Got client connected from: "</span> + socket.getInetAddress)</div><div class="line"></div><div class="line">      <span class="keyword">val</span> out = <span class="keyword">new</span> PrintWriter(socket.getOutputStream(), <span class="keyword">true</span>)</div><div class="line">      <span class="keyword">while</span> (<span class="keyword">true</span>) {</div><div class="line">        Thread.sleep(args(<span class="number">1</span>).toLong)</div><div class="line"></div><div class="line">        <span class="keyword">val</span> num = random.nextInt(MaxEvents)</div><div class="line">        <span class="keyword">val</span> data = generateNoisyData(num)</div><div class="line"></div><div class="line">        data.foreach { <span class="keyword">case</span> (y, x) =&gt;</div><div class="line">          <span class="keyword">val</span> xStr = x.data.mkString(<span class="string">","</span>)</div><div class="line">          <span class="keyword">val</span> content = s<span class="string">"$y\t$xStr"</span></div><div class="line"></div><div class="line">          println(content)</div><div class="line"></div><div class="line">          out.write(content)</div><div class="line">          out.write(<span class="string">"\n"</span>)</div><div class="line">        }</div><div class="line">      }</div><div class="line">      socket.close()</div><div class="line">    }</div><div class="line">  }.start()</div><div class="line">}</div></pre></td></tr></table></figure>

<p><br></p>
<h3 id="实时_Machine_Learning_模型">实时 Machine Learning 模型</h3>
<p>&nbsp;&nbsp; <font size="2"> I.    指定 spark-master/interval 等参数，创建 StreamingContext（此处可以利用 <font color="blue">local[n]</font> 快速开发）</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (args.length &lt; <span class="number">4</span>) {</div><div class="line">  System.err.println(<span class="string">"Usage: WindowCounter &lt;master&gt; &lt;hostname&gt; &lt;port&gt; &lt;interval&gt; \n"</span> +</div><div class="line">    <span class="string">"In local mode, &lt;master&gt; should be 'local[n]' with n &gt; 1"</span>)</div><div class="line">  System.exit(<span class="number">1</span>)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">val</span> ssc = <span class="keyword">new</span> StreamingContext(args(<span class="number">0</span>), <span class="string">"ML Analysis"</span>, Seconds(args(<span class="number">3</span>).toInt))</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> II.    获取到发送过来的 源数据</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> stream = ssc.socketTextStream(args(<span class="number">1</span>), args(<span class="number">2</span>).toInt, StorageLevel.MEMORY_ONLY_SER)</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> III.    利用 DenseVector.zeros[Double] 创建全零的初始矩阵<br>&nbsp;&nbsp; <font size="2"> IV.    使用 StreamingLinearRegressionWithSGD 创建 流式随机递归下降的线性回归 模型<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font size="2">    目前 MLlib 只支持 Streaming ( KMeans / LinearRegression / LinearRegressionWithSGD ) in <a href="https://github.com/apache/spark/" target="_blank" rel="external">Spark 1.4.1</a><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font size="2">    Streaming MLlib 和普通的 MLlib 没有本质上的区别，只是输入的训练集是 DStream，需要使用 foreachRDD/map 进行 训练/预测 </font></font></font></font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> NumFeatures = <span class="number">100</span></div><div class="line"><span class="keyword">val</span> zeroVector = DenseVector.zeros[Double](NumFeatures)</div><div class="line"><span class="keyword">val</span> model = <span class="keyword">new</span> StreamingLinearRegressionWithSGD()</div><div class="line">  .setInitialWeights(Vectors.dense(zeroVector.data))</div><div class="line">  .setNumIterations(<span class="number">1</span>)</div><div class="line">  .setStepSize(<span class="number">0.01</span>)</div><div class="line"></div><div class="line"><span class="keyword">val</span> labeledStream = stream.map { event =&gt;</div><div class="line">  <span class="keyword">val</span> split = event.split(<span class="string">"\t"</span>)</div><div class="line">  <span class="keyword">val</span> y = split(<span class="number">0</span>).toDouble</div><div class="line">  <span class="keyword">val</span> features = split(<span class="number">1</span>).split(<span class="string">","</span>).map(_.toDouble)</div><div class="line">  LabeledPoint(label = y, features = Vectors.dense(features))</div><div class="line">}</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> V.    利用 模型 进行 train / predict</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">model.trainOn(labeledStream)</div><div class="line"></div><div class="line">   <span class="keyword">val</span> predictAndTrue = labeledStream.transform { rdd =&gt;</div><div class="line">     <span class="keyword">val</span> latest = model.latestModel()</div><div class="line">     rdd.map { point =&gt;</div><div class="line">       <span class="keyword">val</span> predict = latest.predict(point.features)</div><div class="line">       (predict - point.label)</div><div class="line">     }</div><div class="line">   }</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> VI.    通过 MSE（Mean Squared Error） 均方差 和 RMSE（Root Mean Squared Error） 均方根误差 对模型的性能进行评估  (这里也可以使用 RegressionMetrics 来实现)</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">predictAndTrue.foreachRDD { (rdd, time) =&gt;</div><div class="line">  <span class="keyword">val</span> mse = rdd.map { <span class="keyword">case</span> (err) =&gt; err * err }.mean()</div><div class="line">  <span class="keyword">val</span> rmse = math.sqrt(mse)</div><div class="line">  println( s<span class="string">"""</span></div><div class="line">              |-------------------------------------------</div><div class="line">              |Time: $time</div><div class="line">      |-------------------------------------------</div><div class="line">                  """.stripMargin)</div><div class="line">  println(s<span class="string">"MSE current batch: Model : $mse"</span>)</div><div class="line">  println(s<span class="string">"RMSE current batch: Model : $rmse"</span>)</div><div class="line">  println(<span class="string">"...\n"</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> VII.    启动 Spark 上下文</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ssc.start()</div><div class="line">ssc.awaitTermination()</div></pre></td></tr></table></figure>

<p><br></p>
<h2 id="一劳永逸了？Not_at_all"><strong><font color="blue"><em>一劳永逸了？Not at all</em></font></strong></h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp; <font size="3"> 一个优秀的 ML 模型，是要结合具体业务，从对数据流入的清洗，特征值维度的考量，模型类型的选择，到最终的性能的评估、监控、持续优化，都需要仔细地考究，最终才能打造出高效、稳定、精准的数据模型</font></p>
<p><br></p>
<h3 id="数据">数据</h3>
<p>&nbsp;&nbsp; <font size="2"> 对目标数据集进行处理之前，首先就是对数据的类型进行归类，是数值型、类别型、文本型，还是其他一些多媒体、地理信息等<br>&nbsp;&nbsp; <font size="2"> 针对不同的数据，分别采取不同的处理手段，对于类别型常用 1-of-k encoding 对每个类别进行编码<br>&nbsp;&nbsp; <font size="2"> 对于文本型，则会采用 分词、移除 stop words (的、这、地; the/and/but …)、向量化、标准化 (避免度量单位的影响) like:</font></font></font></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">np.random.seed(<span class="number">42</span>)</div><div class="line">x = np.random.randn(<span class="number">10</span>)</div><div class="line">norm_x_2 = np.linalg.norm(x)</div><div class="line">normalized_x = x / norm_x_2</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"x:\n%s"</span> % x</div><div class="line"><span class="keyword">print</span> <span class="string">"2-Norm of x: %2.4f"</span> % norm_x_2</div><div class="line"><span class="keyword">print</span> <span class="string">"Normalized x:\n%s"</span> % normalized_x</div><div class="line"><span class="keyword">print</span> <span class="string">"2-Norm of normalized_x: %2.4f"</span> % np.linalg.norm(normalized_x)</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> 还有还多常用的数据处理方式，如 平均值、中位数、总和、方差、差值、最大值、最小值<br>&nbsp;&nbsp; <font size="2"> 对 time 的处理的方式，还有可以加上 “时间戳”</font></font></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">assign_tod</span><span class="params">(hr)</span>:</span></div><div class="line">   	times_of_day = {</div><div class="line">       	<span class="string">'morning'</span> : range(<span class="number">7</span>, <span class="number">12</span>),</div><div class="line">       	<span class="string">'lunch'</span> : range(<span class="number">12</span>, <span class="number">14</span>),</div><div class="line">       	<span class="string">'afternoon'</span> : range(<span class="number">14</span>, <span class="number">18</span>),</div><div class="line">       	<span class="string">'evening'</span> : range(<span class="number">18</span>, <span class="number">23</span>),</div><div class="line">       	<span class="string">'night'</span> : range(<span class="number">23</span>, <span class="number">7</span>)</div><div class="line">   	}</div><div class="line">   	<span class="keyword">for</span> k, v <span class="keyword">in</span> times_of_day.iteritems():</div><div class="line">   	<span class="keyword">if</span> hr <span class="keyword">in</span> v:</div><div class="line">	    <span class="keyword">return</span> k</div><div class="line"></div><div class="line">time_of_day = hour_of_day.map(<span class="keyword">lambda</span> hr: assign_tod(hr))</div></pre></td></tr></table></figure>

<p><br></p>
<h3 id="特征维度">特征维度</h3>
<p>&nbsp;&nbsp; <font size="2"> 常见的一个影响模型的因素，便是没有对特征 进行标准化</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(element-wise - the preceding mean vector from the feature vector) / the vector of feature standard deviations</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> 利用 StandarScaler 完成标准化工作</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.apache.spark.mllib.feature.StandardScaler</div><div class="line"></div><div class="line"><span class="keyword">val</span> scaler = <span class="keyword">new</span> StandardScaler(withMean = <span class="keyword">true</span>, withStd = <span class="keyword">true</span>).fit(vectors)</div><div class="line"><span class="keyword">val</span> scaledData = data.map(lp =&gt; LabeledPoint(lp.label, scaler.transform(lp.features)))</div></pre></td></tr></table></figure>

<p><br></p>
<h3 id="调整模型">调整模型</h3>
<p>&nbsp;&nbsp; <font size="2"> 首先需要在众多的模型 和 对应的算法 中找到最为适用的选择<br>&nbsp;&nbsp; <font size="2"> 模型的类别主要有，推荐引擎、分类模型、回归模型、聚类模型 等<br>&nbsp;&nbsp; <font size="2"> 相应的实现算法，又有（线性/逻辑/多元）回归、（随机森林）决策树、（朴素/高斯/多项式/伯努利/信念网络）贝叶斯 等<br>&nbsp;&nbsp; <font size="2"> 在选择的时候，更多会考虑 特征值是否多维（可以尝试降维），目标类别是 multiclass，binary，还是 probability（连续值）</font></font></font></font></p>
<p>&nbsp;&nbsp; <font size="2"> 根据 数据集的 稀疏程度 对正则化 (Regularizer) 进行调整:</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">zero: 没有任何正规化操作</div><div class="line">L1:   SGD（Stochastic gradient descent，随机梯度下降）</div><div class="line">L2:   LBFGS（Limited-memory BFGS，受限的 BFGS）</div><div class="line"></div><div class="line">L2 相比 L1 更为平滑（同样，L1 可以让 稀疏的数据集 得到更 直观的模型）</div><div class="line"></div><div class="line">还有其它 求最优解 的方法，如 求全局最优解的 BGD（Batch gradient descent，批量梯度下降）</div><div class="line">但是，由于每次迭代都需要依据训练集中所有的数据，所以速度很慢；</div><div class="line">以及 CG（Conjugate gradient，共轭梯度法），但还没有被 Spark MLlib 所支持，可以在 Breeze 中找到它</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> 可以通过 setUpdater 将模型的 规则化算法 设置为 L1（默认为 L2）</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.apache.spark.mllib.optimization.L1Updater</div><div class="line"></div><div class="line"><span class="keyword">val</span> svmAlg = <span class="keyword">new</span> SVMWithSGD()</div><div class="line">svmAlg.optimizer.</div><div class="line">  setNumIterations(<span class="number">200</span>).</div><div class="line">  setRegParam(<span class="number">0.1</span>).</div><div class="line">  setUpdater(<span class="keyword">new</span> L1Updater)</div><div class="line"><span class="keyword">val</span> modelL1 = svmAlg.run(training)</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> 当然，还有举不胜举的优化方式 sorry for the limit of article’s lenght :-)</font></p>
<p><br></p>
<h3 id="性能评估指标">性能评估指标</h3>
<p>&nbsp;&nbsp; <font size="2"> I. 针对不同的业务，对性能评测的手段，也需要相应取舍，毕竟有些 “宁可错杀一千” 的变态 防护系统，就需要对 recall 有较高的要求，而 precision 则相对宽松些<br>&nbsp;&nbsp; <font size="2"> 这是便可采用 ROC（receiver operating characteristic）curve 评测引擎:</font></font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// binary classification</span></div><div class="line"><span class="keyword">val</span> metrics = Seq(lrModel, svmModel).map { model =&gt;</div><div class="line">  <span class="keyword">val</span> scoreAndLabels = data.map { point =&gt;</div><div class="line">    (model.predict(point.features), point.label)</div><div class="line">  }</div><div class="line">  <span class="keyword">val</span> metrics = <span class="keyword">new</span> BinaryClassificationMetrics(scoreAndLabels)</div><div class="line">  (model.getClass.getSimpleName, metrics.areaUnderPR, metrics.areaUnderROC)</div><div class="line">}</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> 如果是 贝叶斯/决策树 的数据模型，则可以用 0.5 对其进行划分，转换为 binary</font></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// naive bayes</span></div><div class="line"><span class="keyword">val</span> nbMetrics = Seq(nbModel).map { model =&gt;</div><div class="line">  <span class="keyword">val</span> scoreAndLabels = nbData.map { point =&gt;</div><div class="line">    <span class="keyword">val</span> score = model.predict(point.features)</div><div class="line">    (<span class="keyword">if</span> (score &gt; <span class="number">0.5</span>) <span class="number">1.0</span> <span class="keyword">else</span> <span class="number">0.0</span>, point.label)</div><div class="line">  }</div><div class="line">  <span class="keyword">val</span> metrics = <span class="keyword">new</span> BinaryClassificationMetrics(scoreAndLabels)</div><div class="line">  (model.getClass.getSimpleName, metrics.areaUnderPR, metrics.areaUnderROC)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// decision tree</span></div><div class="line"><span class="keyword">val</span> dtMetrics = Seq(dtModel).map { model =&gt;</div><div class="line">  <span class="keyword">val</span> scoreAndLabels = data.map { point =&gt;</div><div class="line">    <span class="keyword">val</span> score = model.predict(point.features)</div><div class="line">    (<span class="keyword">if</span> (score &gt; <span class="number">0.5</span>) <span class="number">1.0</span> <span class="keyword">else</span> <span class="number">0.0</span>, point.label)</div><div class="line">  }</div><div class="line">  <span class="keyword">val</span> metrics = <span class="keyword">new</span> BinaryClassificationMetrics(scoreAndLabels)</div><div class="line">  (model.getClass.getSimpleName, metrics.areaUnderPR, metrics.areaUnderROC)</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">val</span> allMetrics = metrics ++ nbMetrics ++ dtMetrics</div><div class="line">allMetrics.foreach { <span class="keyword">case</span> (m, pr, roc) =&gt;</div><div class="line">  println(f<span class="string">"$m, Area under PR: ${pr * 100.0}%2.4f%%, Area under ROC: ${roc * 100.0}%2.4f%%"</span>)</div><div class="line">}</div></pre></td></tr></table></figure>

<p>&nbsp;&nbsp; <font size="2"> II. 然而，如果是一些推荐系统，更多的希望能够了解到 大体的预测精度，则可以采用 MAP（Mean Average Precision） 平均精度均值 进行评估</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MAP 同时还解决了 precision，recall，F-measure 的单点值局限性</div></pre></td></tr></table></figure>

<p><br></p>
<p><strong><font size="2"> <em>至此，相信你已经对 Spark 这个生态圈有了大致轮廓了，下面就是一步一步地 在 实践 和 深入学习中，体验大数据的乐趣啦 O(∩_∩)O~~</em></font></strong></p>
<p><br></p>
<p><img src="/../2015-8-13/storm.jpg" alt=""><br><img src="/../2015-8-13/Spark.png" alt=""></p>
<h4 id="更多资源：QQ_group:_(Hadoop_253793003)">更多资源：QQ group: (<font color="blue">Hadoop 253793003</font>)</h4>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-10T06:28:08.000Z"><a href="/2015/05/10/Storm-与-Kafka-的整合之三：Combination/">May 10 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/10/Storm-与-Kafka-的整合之三：Combination/">Storm 与 Kafka 的整合之三：Combination</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="搭建_Storm_和_Kafka_的基础环境"><strong><font color="blue"><em>搭建 Storm 和 Kafka 的基础环境</em></font></strong></h2>
<h3 id="搭建_Storm_集群_(本地模式)"><strong>搭建 <a href="http://storm.apache.org/documentation/Home.html" target="_blank" rel="external">Storm</a> 集群 (本地模式)</strong></h3>
<h3 id="搭建_Kafka_环境"><strong>搭建 <a href="http://kafka.apache.org/documentation.html" target="_blank" rel="external">Kafka</a> 环境</strong></h3>
<h3 id="启动_Kafka"><strong>启动 Kafka</strong></h3>
<h4 id="-_start_the_zookeeper_and_kafka_server">- start the zookeeper and kafka server</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bin/zookeeper-server-start.<span class="keyword">sh</span> config/zookeeper.properties</div></pre></td></tr></table></figure>



<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bin/kafka-server-<span class="operator"><span class="keyword">start</span>.sh config/<span class="keyword">server</span>.properties</span></div></pre></td></tr></table></figure>

<h4 id="-_create_a_topic">- create a topic</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">bin/kafka</span><span class="literal">-</span><span class="comment">topics</span><span class="string">.</span><span class="comment">sh</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">create</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">zookeeper</span> <span class="comment">localhost:2181</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">replication</span><span class="literal">-</span><span class="comment">factor</span> <span class="comment">1</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">partitions</span> <span class="comment">1</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">topic</span> <span class="comment">my</span><span class="literal">-</span><span class="comment">replicated</span><span class="literal">-</span><span class="comment">topic</span></div></pre></td></tr></table></figure>

<p><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;We can now see that topic if we run the list topic command:</font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bin/kafka-topics.<span class="keyword">sh</span> --<span class="keyword">list</span> --zookeeper localhos<span class="variable">t:2181</span></div></pre></td></tr></table></figure>

<h2 id="发送_Message_往_Kafka"><strong><font color="blue"><em>发送 Message 往 Kafka</em></font></strong></h2>
<h3 id="编写_SendMessageToKafka"><strong>编写 SendMessageToKafka</strong></h3>
<ol>
<li><font size="2"> 根据 kafka 中 cluster 的属性，定义好 Producer</font></li>
<li><font size="2"> 利用 Producer.send(KeyedMessage) 方法，将 “topic - message” 发送给 Kafka</font></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SendMessageToKafka</span> </span>{</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Producer&lt;String, String&gt; producer;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span>() {</div><div class="line">		Properties props = <span class="keyword">new</span> Properties();</div><div class="line">		props.put(<span class="string">"zk.connect"</span>, <span class="string">"192.168.1.201:2181"</span>);</div><div class="line">		props.put(<span class="string">"serializer.class"</span>, <span class="string">"kafka.serializer.StringEncoder"</span>);</div><div class="line">		props.put(<span class="string">"metadata.broker.list"</span>, <span class="string">"192.168.1.201:9092"</span>);</div><div class="line">		ProducerConfig config = <span class="keyword">new</span> ProducerConfig(props);</div><div class="line">		producer = <span class="keyword">new</span> Producer&lt;String, String&gt;(config);</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(String... arg) {</div><div class="line"></div><div class="line">		init();</div><div class="line"></div><div class="line">		KeyedMessage&lt;String, String&gt; data = <span class="keyword">new</span> KeyedMessage&lt;String, String&gt;(</div><div class="line">				<span class="string">"my-replicated-topic"</span>, <span class="string">"asdf2015"</span>);</div><div class="line">		producer.send(data);</div><div class="line">		producer.close();</div><div class="line"></div><div class="line">	}</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="run_the_main_method"><strong>run the main method</strong></h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">com.yuzhouwan.hadoop.customer_behaviour_analyse.kafka.SendMessageToKafka</div></pre></td></tr></table></figure>

<h3 id="check_out_the_message_that_tht_broker_catched"><strong>check out the message that tht broker catched</strong></h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">bin/kafka</span><span class="literal">-</span><span class="comment">console</span><span class="literal">-</span><span class="comment">consumer</span><span class="string">.</span><span class="comment">sh</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">zookeeper</span> <span class="comment">localhost:2181</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">from</span><span class="literal">-</span><span class="comment">beginning</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">topic</span> <span class="comment">my</span><span class="literal">-</span><span class="comment">replicated</span><span class="literal">-</span><span class="comment">topic</span></div></pre></td></tr></table></figure>

<p>Then, u will see that the ‘asdf2015’ message was sent sucessfully.</p>
<h2 id="从_Kafka_中获得_Message"><strong><font color="blue"><em>从 Kafka 中获得 Message</em></font></strong></h2>
<h3 id="编写_TestMessageScheme"><strong>编写 TestMessageScheme</strong></h3>
<p><font size="2"> 在 deserialize(byte[]) 方法中将 message 显示</font></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMessageScheme</span> <span class="keyword">implements</span> <span class="title">Scheme</span> </span>{</div><div class="line"></div><div class="line">	...</div><div class="line">	</div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> List&lt;Object&gt; <span class="title">deserialize</span>(<span class="keyword">byte</span>[] ser) {</div><div class="line"></div><div class="line">		String msg;</div><div class="line">		<span class="keyword">try</span> {</div><div class="line">			msg = <span class="keyword">new</span> String(ser, <span class="string">"UTF-8"</span>);</div><div class="line">			System.out.println(<span class="string">"$$$$$$$$$$$$$$"</span> + msg);</div><div class="line">			<span class="keyword">return</span> <span class="keyword">new</span> Values(msg);</div><div class="line">		} <span class="keyword">catch</span> (UnsupportedEncodingException e) {</div><div class="line">			LOGGER.error(<span class="string">"Can not parse the provide message from bytes."</span>);</div><div class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">		}</div><div class="line">	}</div><div class="line"></div><div class="line">	...</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="编写_ShowKafkaMessageBolt"><strong>编写 ShowKafkaMessageBolt</strong></h3>
<ol>
<li><font size="2">在 prepare(Map, TopologyContext, OutputCollector) 中得到:OutputCollector(emit方法完成 message 的发射)、Context(提供 name/id 之类的属性)</font></li>
<li><font size="2">在 execute(Tuple) 中完成 message 处理工作</font></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ShowKafkaMessageBolt</span> <span class="keyword">implements</span> <span class="title">IRichBolt</span> </span>{</div><div class="line"></div><div class="line">	<span class="keyword">private</span> OutputCollector collector;</div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line"></div><div class="line">	<span class="annotation">@SuppressWarnings</span>(<span class="string">"rawtypes"</span>)</div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span>(Map stormConf, TopologyContext context,</div><div class="line">			OutputCollector collector) {</div><div class="line">		<span class="keyword">this</span>.collector = collector;</div><div class="line">		<span class="keyword">this</span>.name = context.getThisComponentId();</div><div class="line">		<span class="keyword">this</span>.id = context.getThisTaskId();</div><div class="line">		System.out.println(<span class="string">"Bolt: "</span> + name + <span class="string">" and Id: "</span> + id</div><div class="line">				+ <span class="string">" prepared ##################"</span>);</div><div class="line"></div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span>(Tuple input) {</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (input != <span class="keyword">null</span>) {</div><div class="line">			String message = input.getString(<span class="number">0</span>);</div><div class="line">			collector.emit(<span class="keyword">new</span> Values(message));</div><div class="line">			System.out.println(message);</div><div class="line">		}</div><div class="line"></div><div class="line">		collector.ack(input);</div><div class="line"></div><div class="line">	}</div><div class="line"></div><div class="line">	...</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="编写_BehaviourAnalyse"><strong>编写 BehaviourAnalyse</strong></h3>
<ol>
<li>基于 zookeeper属性 定义 Broker</li>
<li>整合 broker、topic、zkRoot、spoutId 和 TestMessageScheme 为 SpoutConfig，完成 KafkaSpout 的实例化</li>
<li>利用 LocalCluster 完成 topology 的提交</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BehaviourAnalyse</span> </span>{</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(String[] args) {</div><div class="line"></div><div class="line">		BrokerHosts brokerHosts = <span class="keyword">new</span> ZkHosts(<span class="string">"192.168.1.201:2181"</span>);</div><div class="line"></div><div class="line">		String topic = <span class="string">"my-replicated-topic"</span>;</div><div class="line"></div><div class="line">		<span class="javadoc">/**</span></div><div class="line">		 * We can get the param from the 'config/zookeeper.properties' path.&lt;BR&gt;</div><div class="line">		 * # the directory where the snapshot is stored.&lt;BR&gt;</div><div class="line">		 * dataDir=/tmp/zookeeper</div><div class="line">		 */</div><div class="line">		String zkRoot = <span class="string">"/tmp/zookeeper"</span>;</div><div class="line">		String spoutId = <span class="string">"myKafka"</span>;</div><div class="line"></div><div class="line">		SpoutConfig spoutConfig = <span class="keyword">new</span> SpoutConfig(brokerHosts, topic, zkRoot,</div><div class="line">				spoutId);</div><div class="line">		spoutConfig.scheme = <span class="keyword">new</span> SchemeAsMultiScheme(<span class="keyword">new</span> TestMessageScheme());</div><div class="line"></div><div class="line">		TopologyBuilder builder = <span class="keyword">new</span> TopologyBuilder();</div><div class="line">		KafkaSpout kafkaSpout = <span class="keyword">new</span> KafkaSpout(spoutConfig);</div><div class="line">		builder.setSpout(<span class="string">"kafka-spout"</span>, kafkaSpout);</div><div class="line"></div><div class="line">		builder.setBolt(<span class="string">"show-message-bolt"</span>, <span class="keyword">new</span> ShowKafkaMessageBolt())</div><div class="line">				.shuffleGrouping(<span class="string">"kafka-spout"</span>);</div><div class="line"></div><div class="line">		Config conf = <span class="keyword">new</span> Config();</div><div class="line">		conf.setDebug(<span class="keyword">true</span>);</div><div class="line">		conf.put(Config.TOPOLOGY_MAX_SPOUT_PENDING, <span class="number">1</span>);</div><div class="line"></div><div class="line">		LocalCluster cluster = <span class="keyword">new</span> LocalCluster();</div><div class="line">		cluster.submitTopology(<span class="string">"Show-Message-From-Kafka"</span>, conf,</div><div class="line">				builder.createTopology());</div><div class="line"></div><div class="line">	}</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="run_the_main_method-1"><strong>run the main method</strong></h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">com.yuzhouwan.hadoop.customer_behaviour_analyse.BehaviourAnalyse</div></pre></td></tr></table></figure>

<h3 id="start_a_kafka’s_producer"><strong>start a kafka’s producer</strong></h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">bin/kafka-console-producer.<span class="keyword">sh</span> --broker-<span class="keyword">list</span> localhos<span class="variable">t:9092</span> --topic my-replicated-topic</div></pre></td></tr></table></figure>

<p>Input a sentence ending, like:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">This <span class="keyword">is</span> a message <span class="keyword">from</span> kafka.</div></pre></td></tr></table></figure>

<p>You will see the information that be show in console sucessfully :-)</p>
<h2 id="Storm_和_Kafka_双向整合已经完成"><strong><font color="blue"><em>Storm 和 Kafka 双向整合已经完成</em></font></strong></h2>
<p>完全的整合，及其运用，见 <a href="https://github.com/MasteringStorm/customer-haviour-analyse" target="_blank" rel="external">here</a></p>
<h2 id="小技巧"><strong><font color="blue"><em>小技巧</em></font></strong></h2>
<h3 id="get_the_value_of_metadata-broker-list"><strong>get the value of metadata.broker.list</strong></h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">vim</span> config/producer.properties</div></pre></td></tr></table></figure>

<h3 id="查看_storm_与其他框架的支持与否">查看 storm 与其他框架的支持与否</h3>
<p><a href="http://mvnrepository.com/artifact/org.apache.storm" target="_blank" rel="external">http://mvnrepository.com/artifact/org.apache.storm</a></p>
<p><font size="2"><strong><em><a href="https://github.com/MasteringStorm/shopping-web-site" target="_blank" rel="external">[Source]</a></em></strong></font></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-05-10T04:43:42.000Z"><a href="/2015/05/10/Storm-与-Kafka-的整合之二：Kafka/">May 10 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/05/10/Storm-与-Kafka-的整合之二：Kafka/">Storm 与 Kafka 的整合之二：Kafka</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="什么是_Kafka?"><strong><font color="blue"><em>什么是 Kafka?</em></font></strong></h2>
<p>&nbsp;&nbsp; <font size="3"> Kafka is a distributed, partitioned, replicated commit log service. It provides the functionality of a messaging system, but with a unique design. - - <a href="https://kafka.apache.org/" target="_blank" rel="external">Official website</a></font></p>
<h2 id="为什么要有_Kafka?"><strong><font color="blue"><em>为什么要有 Kafka?</em></font></strong></h2>
<h3 id="分布式">分布式</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">具备经济、快速、可靠、易扩充、数据共享、设备共享、通讯方便、灵活等分布式所具备的特性</div></pre></td></tr></table></figure>

<h3 id="高吞吐量">高吞吐量</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">同时为发布者和订阅者提高吞吐量</div></pre></td></tr></table></figure>

<h3 id="高可靠性">高可靠性</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">支持多个订阅者，当订阅失败的时候，能够自动均衡订阅者</div></pre></td></tr></table></figure>

<h3 id="离线_&amp;_实时性">离线 &amp; 实时性</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">能将消息持久化，进行批量处理</div></pre></td></tr></table></figure>

<h2 id="Kafka_工作机制"><strong><font color="blue"><em>Kafka 工作机制</em></font></strong></h2>
<h3 id="一些主要概念">一些主要概念</h3>
<ul>
<li>Topic（主题）</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">A topic is a category or feed name to which messages are published.</div></pre></td></tr></table></figure>

<ul>
<li>Producers（发布者）</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Producers publish data to the topics of their choice. The producer is responsible <span class="keyword">for</span> choosing which message to assign to which partition within the topic.</div></pre></td></tr></table></figure>

<ul>
<li>Consumers（订阅者）</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Messaging traditionally has two models: queuing and publish-subscribe. </div><div class="line">In a queue, a pool of consumers may read from a server and each message goes to one of them; </div><div class="line">in publish-subscribe the message is broadcast to all consumers.</div></pre></td></tr></table></figure>

<h3 id="示意图">示意图</h3>
<p><img src="/../2015-5-10/kafka.png" alt=""></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-25T14:57:15.000Z"><a href="/2015/04/25/Qcon-2015-见闻之一：猿题库/">Apr 25 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/25/Qcon-2015-见闻之一：猿题库/">Qcon 2015 见闻之一：猿题库</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="什么是_‘猿题库’_?"><strong><font color="blue"><em>什么是 ‘猿题库’ ?</em></font></strong></h2>
<p>&nbsp;&nbsp; <font size="3"> 初高中刷题利器 - - <a href="http://yuantiku.com/" target="_blank" rel="external">猿题库 官网</a></font></p>
<p>&nbsp;&nbsp; <font size="3"> 猿：猿到人的进化 - - <a href="http://qconbeijing.com/" target="_blank" rel="external">QCon</a></font></p>
<p>&nbsp;&nbsp; <font size="3"> 猿题库是一款手机智能做题软件，目前已经完成对初中和高中6个年级的全面覆盖。 - - <a href="http://baike.baidu.com/view/10119401.htm" target="_blank" rel="external">百度百科</a></font></p>
<p>&nbsp;&nbsp; <font size="3"> 2014年7月，猿题库宣布完成1500万美元的C轮融资。融资完成后，猿题库的估值达到1.25亿美元。至此，公司刚刚成立两年。 - - <a href="http://tech.163.com/14/0727/09/A25C1HDC000915BF.html" target="_blank" rel="external">网易科技</a></font></p>
<h2 id="猿题库_如何在_在线教育领域_应用_ML?"><strong><font color="blue"><em>猿题库 如何在 在线教育领域 应用 ML?</em></font></strong></h2>
<h3 id="小猿搜题"><strong>小猿搜题</strong></h3>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">Photo(手机横屏采集题目) -&gt;</span> <span class="constant">Prepare</span> -&gt; <span class="constant">Split</span> -&gt; <span class="constant">CNN</span>识别 -&gt; <span class="constant">NLP</span>纠错 -&gt; 搜索 -&gt; 返回题目</span></div><div class="line">                       -&gt; 插图匹配 ---------------------------- -&gt;</div></pre></td></tr></table></figure>

<h4 id="①_Photo">① Photo</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">内容多样，模糊图(<span class="number">30</span>%)，公式(<span class="number">50</span>%)</div></pre></td></tr></table></figure>

<h4 id="②_Prepare">② Prepare</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">横屏(转向)，黑底白字</div></pre></td></tr></table></figure>

<h4 id="③_Split">③ Split</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">公式分词(根号)</div></pre></td></tr></table></figure>

<h4 id="④_CNN识别">④ CNN识别</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">卷积神经网络(Model)、标记数据、自动生成、DL(SGD -&gt;</span> 高斯牛顿)</span></div></pre></td></tr></table></figure>

<h4 id="⑤_NLP纠错">⑤ NLP纠错</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">语言模型(example: '回边形' -&gt;</span> <span class="string">'四边形'</span>)</span></div></pre></td></tr></table></figure>

<h4 id="⑥_搜索">⑥ 搜索</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">分词、inverted-index、排序、<span class="constant">Learning</span> to <span class="constant">Rank</span>、<span class="constant">GBRT</span></div></pre></td></tr></table></figure>

<h4 id="⑦_插图匹配">⑦ 插图匹配</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="constant">SIFT</span>、高命中(直接进行 ⑥)</div></pre></td></tr></table></figure>

<hr>
<h3 id="学生能力预测"><strong>学生能力预测</strong></h3>
<h4 id="&nbsp;&nbsp;项目反应理论">&nbsp;&nbsp;项目反应理论</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">IRT -&gt;</span> <span class="constant">FTRL</span></span></div></pre></td></tr></table></figure>

<h4 id="&nbsp;&nbsp;特征">&nbsp;&nbsp;特征</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">用户(学校 + 地区 + 目标考试)、题目(知识点 + 关键字)、时序(距离目标考试时间)</div></pre></td></tr></table></figure>

<hr>
<h3 id="猿辅导老师推荐"><strong>猿辅导老师推荐</strong></h3>
<h4 id="&nbsp;&nbsp;推荐系统">&nbsp;&nbsp;推荐系统</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">冷启动、<span class="constant">Item</span>-base</div></pre></td></tr></table></figure>

<h4 id="&nbsp;&nbsp;ML">&nbsp;&nbsp;ML</h4>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">logistic factorization machine、<span class="constant">E</span>&<span class="constant">E</span>(挖掘潜力)</div></pre></td></tr></table></figure>

<h2 id="猿题库_的未来走向"><strong><font color="blue"><em>猿题库 的未来走向</em></font></strong></h2>
<h3 id="知识图谱"><strong>知识图谱</strong></h3>
<p> &nbsp;&nbsp; 学生成长之路</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">题目 + 学生 = 提升后的学生 (可量化)</div></pre></td></tr></table></figure>

<h3 id="手写识别"><strong>手写识别</strong></h3>
<ul>
<li>手写搜题</li>
<li>解答题</li>
<li>自动判卷</li>
</ul>
<h3 id="高考机器"><strong>高考机器</strong></h3>
<pre><code>机器自动出题、做题
</code></pre><h3 id="智能芯片"><strong>智能芯片</strong></h3>
<pre><code>极短的时间内，将十几年需要学习的知识学习完
</code></pre><p><font color="red"><strong> 最后感谢：猿题库 研究部总监 — <a href="http://2015.qconbeijing.com/speakers/201685" target="_blank" rel="external">邓澍军</a> 的精彩演讲！</strong></font></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  
    <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-04-22T11:09:42.000Z"><a href="/2015/04/22/Storm-与-Kafka-的整合之一：Storm/">Apr 22 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/04/22/Storm-与-Kafka-的整合之一：Storm/">Storm 与 Kafka 的整合之一：Storm</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="什么是_Storm?"><strong><font color="blue"><em>什么是 Storm?</em></font></strong></h2>
<p>&nbsp;&nbsp; <font size="3"> Apache Storm is a free and open source distributed realtime computation system. - - <a href="https://storm.apache.org/" target="_blank" rel="external">Official website</a></font></p>
<h2 id="为什么要有_Storm?"><strong><font color="blue"><em>为什么要有 Storm?</em></font></strong></h2>
<h3 id="分布式">分布式</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">具备经济、快速、可靠、易扩充、数据共享、设备共享、通讯方便、灵活等分布式所具备的特性</div></pre></td></tr></table></figure>

<h3 id="可扩展性">可扩展性</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">计算在多线程、进程 和 服务器之间并行进行</div></pre></td></tr></table></figure>

<h3 id="高可靠性">高可靠性</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">能管理工作进程 和 节点的故障</div><div class="line">消息处理，能得到一次完成处理的保证</div></pre></td></tr></table></figure>

<h3 id="编程模型简单">编程模型简单</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">降低了并行批处理复杂性</div></pre></td></tr></table></figure>

<h3 id="高效实时">高效实时</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">利用 ZeroMQ 保证了消息的快速处理</div></pre></td></tr></table></figure>

<h3 id="支持热部署">支持热部署</h3>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">加速应用开发</div></pre></td></tr></table></figure>

<h2 id="Storm_工作机制"><strong><font color="blue"><em>Storm 工作机制</em></font></strong></h2>
<h3 id="一些主要概念">一些主要概念</h3>
<ul>
<li>Topology（计算拓扑）</li>
<li>Stream（消息流）</li>
<li>Spout（消息源）</li>
<li>Bolt（消息处理者）</li>
<li>grouping（数据的分发方式）</li>
<li>Topology（拓扑）</li>
<li>Worker（工作进程）</li>
<li>Task（执行具体逻辑的任务）</li>
<li>Executor（执行 Task 的线程）</li>
<li>Configuration（配置）</li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  

  <nav id="pagination">
  
  
    <a href="/archives/2015/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:yuzhouwan.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/Antlr/">Antlr</a><small>1</small></li>
  
    <li><a href="/categories/HashMap/ConcurrentHashMap/">ConcurrentHashMap</a><small>1</small></li>
  
    <li><a href="/categories/Hadoop/">Hadoop</a><small>1</small></li>
  
    <li><a href="/categories/HashMap/">HashMap</a><small>1</small></li>
  
    <li><a href="/categories/Hexo/">Hexo</a><small>1</small></li>
  
    <li><a href="/categories/JavaScript/">JavaScript</a><small>1</small></li>
  
    <li><a href="/categories/Storm/Kafka/">Kafka</a><small>1</small></li>
  
    <li><a href="/categories/Kafka/">Kafka</a><small>1</small></li>
  
    <li><a href="/categories/Node-js/Module/">Module</a><small>1</small></li>
  
    <li><a href="/categories/Node-js/">Node.js</a><small>3</small></li>
  
    <li><a href="/categories/Python/">Python</a><small>1</small></li>
  
    <li><a href="/categories/Qcon/">Qcon</a><small>1</small></li>
  
    <li><a href="/categories/Hadoop/RPC/">RPC</a><small>1</small></li>
  
    <li><a href="/categories/SSO/">SSO</a><small>1</small></li>
  
    <li><a href="/categories/Session/">Session</a><small>1</small></li>
  
    <li><a href="/categories/Spark/">Spark</a><small>1</small></li>
  
    <li><a href="/categories/Storm/">Storm</a><small>2</small></li>
  
    <li><a href="/categories/Year-2038-problem/">Year_2038_problem</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/Antlr/">Antlr</a><small>1</small></li>
  
    <li><a href="/tags/Clojure/">Clojure</a><small>1</small></li>
  
    <li><a href="/tags/ClojureScript/">ClojureScript</a><small>1</small></li>
  
    <li><a href="/tags/ConcurrentHashMap/">ConcurrentHashMap</a><small>1</small></li>
  
    <li><a href="/tags/Cookie/">Cookie</a><small>1</small></li>
  
    <li><a href="/tags/ECMAScirpt/">ECMAScirpt</a><small>1</small></li>
  
    <li><a href="/tags/HTTP/">HTTP</a><small>1</small></li>
  
    <li><a href="/tags/Hadoop/">Hadoop</a><small>1</small></li>
  
    <li><a href="/tags/Hash/">Hash</a><small>1</small></li>
  
    <li><a href="/tags/HashMap/">HashMap</a><small>1</small></li>
  
    <li><a href="/tags/Hexo/">Hexo</a><small>1</small></li>
  
    <li><a href="/tags/Hibernate/">Hibernate</a><small>1</small></li>
  
    <li><a href="/tags/JSON/">JSON</a><small>1</small></li>
  
    <li><a href="/tags/JSP/">JSP</a><small>1</small></li>
  
    <li><a href="/tags/Java/">Java</a><small>1</small></li>
  
    <li><a href="/tags/JavaScript/">JavaScript</a><small>1</small></li>
  
    <li><a href="/tags/Kafka/">Kafka</a><small>3</small></li>
  
    <li><a href="/tags/ML/">ML</a><small>1</small></li>
  
    <li><a href="/tags/Module/">Module</a><small>1</small></li>
  
    <li><a href="/tags/NOSQL/">NOSQL</a><small>1</small></li>
  
    <li><a href="/tags/Node-js/">Node.js</a><small>4</small></li>
  
    <li><a href="/tags/PHP/">PHP</a><small>1</small></li>
  
    <li><a href="/tags/Python/">Python</a><small>1</small></li>
  
    <li><a href="/tags/Qcon/">Qcon</a><small>1</small></li>
  
    <li><a href="/tags/RPC/">RPC</a><small>1</small></li>
  
    <li><a href="/tags/SSO/">SSO</a><small>2</small></li>
  
    <li><a href="/tags/Session/">Session</a><small>2</small></li>
  
    <li><a href="/tags/Spark/">Spark</a><small>1</small></li>
  
    <li><a href="/tags/Storm/">Storm</a><small>3</small></li>
  
    <li><a href="/tags/V8/">V8</a><small>1</small></li>
  
    <li><a href="/tags/WebLogic/">WebLogic</a><small>1</small></li>
  
    <li><a href="/tags/Year-2038-problem/">Year_2038_problem</a><small>1</small></li>
  
    <li><a href="/tags/猿题库/">猿题库</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">Tag Cloud</h3>
  <div class="entry">
    <a href="/tags/Antlr/" style="font-size: 10.00px;">Antlr</a><a href="/tags/Clojure/" style="font-size: 10.00px;">Clojure</a><a href="/tags/ClojureScript/" style="font-size: 10.00px;">ClojureScript</a><a href="/tags/ConcurrentHashMap/" style="font-size: 10.00px;">ConcurrentHashMap</a><a href="/tags/Cookie/" style="font-size: 10.00px;">Cookie</a><a href="/tags/ECMAScirpt/" style="font-size: 10.00px;">ECMAScirpt</a><a href="/tags/HTTP/" style="font-size: 10.00px;">HTTP</a><a href="/tags/Hadoop/" style="font-size: 10.00px;">Hadoop</a><a href="/tags/Hash/" style="font-size: 10.00px;">Hash</a><a href="/tags/HashMap/" style="font-size: 10.00px;">HashMap</a><a href="/tags/Hexo/" style="font-size: 10.00px;">Hexo</a><a href="/tags/Hibernate/" style="font-size: 10.00px;">Hibernate</a><a href="/tags/JSON/" style="font-size: 10.00px;">JSON</a><a href="/tags/JSP/" style="font-size: 10.00px;">JSP</a><a href="/tags/Java/" style="font-size: 10.00px;">Java</a><a href="/tags/JavaScript/" style="font-size: 10.00px;">JavaScript</a><a href="/tags/Kafka/" style="font-size: 16.67px;">Kafka</a><a href="/tags/ML/" style="font-size: 10.00px;">ML</a><a href="/tags/Module/" style="font-size: 10.00px;">Module</a><a href="/tags/NOSQL/" style="font-size: 10.00px;">NOSQL</a><a href="/tags/Node-js/" style="font-size: 20.00px;">Node.js</a><a href="/tags/PHP/" style="font-size: 10.00px;">PHP</a><a href="/tags/Python/" style="font-size: 10.00px;">Python</a><a href="/tags/Qcon/" style="font-size: 10.00px;">Qcon</a><a href="/tags/RPC/" style="font-size: 10.00px;">RPC</a><a href="/tags/SSO/" style="font-size: 13.33px;">SSO</a><a href="/tags/Session/" style="font-size: 13.33px;">Session</a><a href="/tags/Spark/" style="font-size: 10.00px;">Spark</a><a href="/tags/Storm/" style="font-size: 16.67px;">Storm</a><a href="/tags/V8/" style="font-size: 10.00px;">V8</a><a href="/tags/WebLogic/" style="font-size: 10.00px;">WebLogic</a><a href="/tags/Year-2038-problem/" style="font-size: 10.00px;">Year_2038_problem</a><a href="/tags/猿题库/" style="font-size: 10.00px;">猿题库</a>
  </div>
</div>


  
<div class="widget tag">
	<h3 class="title">友情链接</h3>
	<ul class="entry">
		<li><a href="http://blog.csdn.net/oasiduofu" title="Asdf's CSDN" target="_blank">JCloud</a>
		</li>
		<li><a href="https://github.com/asdf2014" title="Asdf's Github" target="_blank">asdf2014</a>
		</li>
		<li><a href="https://github.com/MasteringJava" title="Asdf's Java" target="_blank">Mastering Java</a>
		</li>
		<li><a href="https://github.com/MasteringStorm" title="Asdf's Storm" target="_blank">Mastering Storm</a>
		</li>
		<li><a href="https://github.com/MasteringElasticSearch" title="Asdf's ElasticSearch" target="_blank">Mastering ElasticSearch</a>
		</li>
		<li><a href="https://github.com/MasteringSpark" title="Asdf's Spark" target="_blank">Mastering Spark</a>
		</li>
		<li><a href="https://github.com/MasteringGolang" title="Asdf's Golang" target="_blank">Mastering Golang</a>
		</li>
		<li><a href="http://www.yuzhouwan.com" title="asdf blog yuzhouwan" target="_blank"></a>
		</li>
	</ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 asdf
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'yuzhouwan';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>